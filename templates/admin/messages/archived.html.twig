{% extends 'base.html.twig' %}

{% block title %}Message archivés
{% endblock %}

{% block body %}
	<div id="layoutSidenav">
		<div id="layoutSidenav_content">
			<main>
				<div class="container-fluid px-4">
					{% if not messages.items is same as([]) %}
						<h1 class="mt-4">Message archivés</h1>
						<ol class="breadcrumb mb-4">
							<li class="breadcrumb-item">
								<a href="{{ path('homepage') }}">Accueil</a>
							</li>
							<li class="breadcrumb-item active">
								<a href="{{ path('admin_messages_index') }}">Messages</a>
							</li>
							<li class="breadcrumb-item active">Message archivés</li>
						</ol>

						<div class="row">
							<div class="col-lg-12">

								<div class="card mb-4">
									<div class="card-header">
										<i class="fas fa-table mr-1" aria-hidden="true"></i>
										Message archivés
									</div>
									<div class="count m-4">Total des messages archivés:
										{{ messages.getTotalItemCount }}</div>
									<div class="card-body" id="viewtable">
										<div class="dataTable-wrapper dataTable-loading no-footer sortable searchable fixed-columns">
											<div class="dataTable-container">
												<table class="table w-100" data-toggle="table" data-search="true" id="dataTable">
													<caption class="text-center">Message archivés</caption>
													<thead>
														<tr>
															<th scope="col" data-sortable="true" data-field="id">
																Id
															</th>
															<th scope="col" data-sortable="true" data-field="firstname">
																Prénom
															</th>
															<th scope="col" data-sortable="true" data-field="lastname">
																Nom
															</th>
															<th scope="col" data-sortable="true" data-field="email">
																Email
															</th>
															<th scope="col" data-sortable="true" data-field="subject">
																Sujet
															</th>
															<th scope="col" data-sortable="true" data-field="message">
																Message
															</th>
															<th scope="col" data-sortable="true">Reçu le</th>
															<th scope="col" data-sortable="true">Lu ?</th>
															<th scope="col" data-sortable="true">Répondu ?</th>
															<th scope="col" data-sortable="true">Supprimer ?</th>
															<th scope="col">Commentaire</th>
															<th scope="col">Action</th>
														</tr>
													</thead>
													<tbody>
														{% for message in messages %}
															<tr>
																<td>{{ message.id }}</td>
																<td>{{ message.firstname }}</td>
																<td>{{ message.lastname }}</td>
																<td>{{ message.email }}</td>
																<td>{{ message.subject }}</td>
																<td>{{ message.message }}</td>
																<td>
																	<span class="fs-10">{{ message.createdAt|date('d/m/Y')}}
																		à
																		{{ message.createdAt|date('H:i')}}
																	</span>
																</td>
																<td>
																	{{ message.isRead ? '<i class="fas fa-check text-success"></i>' : '<i class="fas fa-times text-danger"></i>' }}
																</td>
																<td>
																	{{ message.isAnswered ? '<i class="fas fa-check text-success"></i>' : '<i class="fas fa-times text-danger"></i>' }}
																</td>
																<td>
																	{{ message.deleted ? '<i class="fas fa-check text-success"></i>' : '<i class="fas fa-times text-danger"></i>' }}
																</td>
																<td>
																	{{ message.comment }}
																</td>
																<td class="text-center me-auto ms-auto">
																	<a href="{{ path('admin_messages_show', {'id': message.id}) }}" class="btn btn-primary btn-sm my-2" data-toggle="tooltip" data-placement="top" title="Voir">
																		<i class="fas fa-eye"></i>
																	</a>
																	<a href="{{ path('admin_messages_update', {'id': message.id}) }}" class="btn btn-primary btn-sm my-2" data-toggle="tooltip" data-placement="top" title="Modifier">

																		<i class="fas fa-edit"></i>
																	</a>
																	{% if not message.deleted %}
																		<a href="{{ path('admin_messages_delete', {'id': message.id}) }}" class="btn btn-danger btn-sm my-2" onclick="confirmDelete(this)" data-item-name="{{ message.email }}" data-item-id="{{ message.id }}" data-token="{{ csrf_token('delete' ~ message.id) }}" data-url="{{ path('admin_messages_delete', {'id': message.id}) }}" data-bs-toggle="modal" data-placement="top" title="Supprimer" data-bs-target="#confirmDeleteModal{{ message.id }}">
																			<i class="fas fa-trash-alt"></i>
																		</a>
																	{% endif %}
																</td>
															</tr>
														{% endfor %}
													</tbody>
												</table>
											</div>
										</div>
									</div>
									<div class="navigation d-flex justify-content-center mt-4">
										{{ knp_pagination_render(messages) }}
									</div>
								</div>
							</div>
						</div>
						<p class="float text-center">
							<a href="#">
								<i class="fa-solid fa-arrow-circle-up" aria-hidden="true"></i>
								Retour au début</a>
						</p>
					{% else %}
						<div class="row mt-5">
							<div class="col-md-12">
								<div class="card">
									<div class="card-body">
										<div class="row">
											<div class="col-md-12">
												<div class="alert alert-warning" role="alert">
													<h4 class="alert-heading">Aucun message n'a été trouvé !</h4>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					{% endif %}
				</div>
			</main>

		{% endblock %}
